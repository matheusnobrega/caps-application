{% extends 'base.html' %}

{% block content %}

<div class="container">
    <h1 class="mt-5">Informações do Paciente</h1>
    <div class="card mt-4">
      <div class="card-header">
        Informações Básicas
      </div>
      <div class="card-body">
        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Nome:</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{ paciente.nome }}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Endereço:</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{ paciente.endereco }}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Data de Nascimento:</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{ paciente.data_nascimento }}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Sexo:</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{ paciente.sexo }}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Naturalidade:</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{ paciente.naturalidade }}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-2 col-form-label">RG:</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{ paciente.rg }}</p>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-2 col-form-label">CPF:</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{ paciente.cpf }}</p>
          </div>
        </div>
        <button class="btn btn-primary" data-toggle="modal" data-target="#editModal">Editar Informações</button>
        
        {% if paciente.unidade_acolhimento is null %}
        <form method="POST" action="{% url 'paciente:insere_unidade_acolhimento' paciente.id %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-success mt-3">Inserir na unidade</button>
        </form>
        {% else %}
        <form method="POST" action="{% url 'paciente:remove_unidade_acolhimento' paciente.id %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-danger mt-3">Remover da unidade</button>
        </form>
        {% endif %}
        
          
        
      </div>
    </div>

    <!-- Tabela de consumo de drogas -->
    <div class="card mt-4">
      <div class="card-header">
        Consumo de Drogas
      </div>
      <div class="card-body">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Nome da Droga</th>
              <th>Idade de Primeiro Uso</th>
              <th>Frequência</th>
              <th>Data do Último Uso</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            
            {% for droga in drogas %}
                <tr>
                    <td>{{ droga.droga.nome }}</td>
                    <td>{{ droga.idade_pu }} anos</td>
                    <td>{{ droga.frequencia }}</td>
                    <td>{{ droga.ultimo_uso|date:"d/m/Y"}}</td>
                    <td>
                      <form method="POST" action="{% url 'paciente:remove_droga' paciente.id droga.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-sm">Deletar</button>
                      </form>
                    </td>
                </tr>
            {% endfor %}
          </tbody>
        </table>
        <a href="{% url 'paciente:adiciona_droga' paciente.id %}" class="btn btn-primary">Adicionar Droga</a>
      </div>
    </div>

    <div class="card mt-4">
      <div class="card-header">
        Evolução
      </div>
      
      <div class="card-body">
        {% for evolucao in evolucoes %}
        <p>{{ evolucao.descritivo }}</p>
        <p>{{ evolucao.data|date:"d/m/Y" }}</p>
        <p><b>{{ evolucao.servidor.nome }}</b></p>
        {% endfor %}
        <a href="{% url 'paciente:adiciona_evolucao' paciente.id %}" class="btn btn-primary">Adicionar Evolução</a>
      </div>
      
    </div>
    

    <!-- Modal para editar informações do paciente -->
    <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true">
      <!-- Conteúdo do modal -->
    </div>

    <!-- Modal para adicionar droga -->
    <div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
      <!-- Conteúdo do modal -->
    </div>
  </div>

  {% endblock %}